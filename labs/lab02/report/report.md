---
## Front matter
title: "Лабораторная работа № 2"
subtitle: "Управление пользователями и группами"
author: "Жукова София Викторовна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Получить представление о работе с учётными записями пользователей и группами пользователей в операционной системе типа Linux.



# Выполнение лабораторной работы

Войдем в систему как обычный пользователь и откроем терминал.
Определим, какую учётную запись пользователя мы используем, введя команду (рис. [-@fig:001]).

![whoami](image/1.png){#fig:001 width=70%}


Выведем на экран более подробную информацию, используя команду (рис. [-@fig:002]).

![id](image/2.png){#fig:002 width=70%}

(UID – id пользователя равный 1000, GID – id группы равный 1000)

Используем команду su для переключения к учётной записи root. При запросе
пароля введем пароль пользователя root (рис. [-@fig:003]).

![Переключение к учётной записи root](image/3.png){#fig:003 width=70%}


(UID – id пользователя равный 0. GID – id группы равный 0)

Просмотрим в безопасном режиме файл /etc/sudoers, используя, например (рис. [-@fig:004]).

![sudo -i visudo](image/4.png){#fig:004 width=70%}

Использование visudo обеспечивает безопасность, надежность и правильность во время редактирования критически важного файла конфигурации, что минимизирует риск ошибок, которые могут негативно сказаться на управлении доступом в системе.

Файл (рис. [-@fig:005]).

![Открывшийся файл](image/5.png){#fig:005 width=70%}


Убедимся, что в открытом с помощью visudo файле присутствует строка %wheel ALL=(ALL) ALL (рис. [-@fig:006]).


![Строка присутствует](image/6.png){#fig:006 width=70%}

Запись %wheel ALL=(ALL) ALL предоставляет членам группы wheel возможность использовать команды с повышенными привилегиями 

Закрываем файл нажимая esc и вводя :wq (рис. [-@fig:007]).


![Закрываем](image/7.png){#fig:007 width=70%}


Создадим пользователя alice, входящего в группу wheel и убедимся, что пользователь alice добавлен в группу wheel (рис. [-@fig:008]).


![Cоздаем и убеждаемся](image/8.png){#fig:008 width=70%}


Зададим пароль для пользователя alice, Переключимся на учётную запись пользователя alice (рис. [-@fig:009]).


![alice](image/9.png){#fig:009 width=70%}


Создадим пользователя bob (рис. [-@fig:010]).


![Создадим](image/10.png){#fig:010 width=70%}


Установим пароль для пользователя bob (рис. [-@fig:011]).


![Пароль](image/11.png){#fig:011 width=70%}


Просмотрим, в какие группы входит пользователь bob (рис. [-@fig:012]).


![Группы](image/12.png){#fig:012 width=70%}

**Создание учётных записей пользователей**

Переключимся в терминале на учётную запись пользователя root (рис. [-@fig:013]).


![root](image/13.png){#fig:013 width=70%}


Откроем файл конфигурации /etc/login.defs для редактирования, используя vim (рис. [-@fig:014]).


![Откроем файл конфигурации](image/14.png){#fig:014 width=70%}

Найдем параметр CREATE_HOME и убедимся, что он установлен в значение yes.(рис. [-@fig:015]).


![Все верно](image/15.png){#fig:015 width=70%}

Также установим параметр USERGROUPS_ENAB no (рис. [-@fig:016]).

![no](image/16.png){#fig:016 width=70%}

Перейдем в каталог /etc/skel, создадим каталоги Pictures и Documents: (рис. [-@fig:017]).

![Создадим](image/17.png){#fig:017 width=70%}

Это позволит добавить эти каталоги по умолчанию во все домашние каталоги пользо-
вателей.

Откроем файл .bashrc(рис. [-@fig:018]).


![Откроем](image/18.png){#fig:018 width=70%}


Изменим содержимое файла .bashrc, добавив строку export EDITOR=/usr/bin/vim (рис. [-@fig:019]).


![Изменим](image/19.png){#fig:019 width=70%}

Эта запись означает, что текстовый редактор vim или редактор mceditor будет уста-
новлен по умолчанию для инструментов, которые нуждаются в изменении текстовых
файлов.

Переключимся в терминале на учётную запись пользователя alice, используя утилиту useradd, создадим пользователя carol(рис. [-@fig:020]).


![Carol](image/20.png){#fig:020 width=70%}


Установим пароль для пользователя carol (рис. [-@fig:021]).


![Установим пароль](image/21.png){#fig:021 width=70%}


Посмотрим  информацию о пользователе carol, проверим, в какую первоначальную группу входит пользователь carol (рис. [-@fig:022]).


![Посмотрим  информацию о пользователе carol](image/22.png){#fig:022 width=70%}

Убедимся, что каталоги Pictures и Documents были созданы в домашнем каталоге пользователя
carol(рис. [-@fig:023]).


![Убедимся](image/23.png){#fig:023 width=70%}

Переключимся в терминале на учётную запись пользователя alice(рис. [-@fig:024]).


![alice](image/24.png){#fig:024 width=70%}


Cтрока записи о пароле пользователя carol в файле /etc/shadow (рис. [-@fig:025]).


![Cтрока записи о пароле](image/25.png){#fig:025 width=70%}

Сначала мы видим зашифрованный пароль, потом срок действия


Изменим свойства пароля пользователя carol следующим образом (рис. [-@fig:026]).

![Изменим свойства пароля](image/26.png){#fig:026 width=70%}

В этой записи срок действия пароля истекает через 90 дней (-x 90). За три дня до
истечения срока действия пользователь получит предупреждение (-w 3). Пароль дол-
жен использоваться как минимум за 30 дней (-n 30) до того, как его можно будет
изменить.

Убедимся в изменении в строке с данными о пароле пользователя carol в файле
/etc/shadow:(рис. [-@fig:027]).

![/etc/shadow](image/27.png){#fig:027 width=70%}

Убедимся, что идентификатор carol существует не во всех трёх файлах:(рис. [-@fig:028]).

![Существует](image/28.png){#fig:028 width=70%}

**Работа с группами**

В этом упражнении создадим две группы и добавим некоторых пользователей
в эти группы.
Находясь под учётной записью пользователя alice, создадим группы main и third:(рис. [-@fig:029]).


![Создадим](image/29.png){#fig:029 width=70%}

Используем usermod для добавления пользователей alice и bob в группу main,
а carol, dan, dave и david — в группу third: (рис. [-@fig:030]).


![usermod](image/30.png){#fig:030 width=70%}


Убедимся, что пользователь carol правильно добавлен в группу third (рис. [-@fig:031]).

![Убедимся](image/31.png){#fig:031 width=70%}

Определим, участниками каких групп являются другие созданные нами пользователи  (рис. [-@fig:032]). (рис. [-@fig:033]).

![bob](image/32.png){#fig:032 width=70%}

![alice](image/33.png){#fig:033 width=70%}

**Контрольные вопросы**

### 1. Команды для получения информации о пользователе и группах
Для получения информации о номере (идентификаторе) пользователя и группах, в которые он включен, используйте команду:
```bash
id username
```
Эта команда выдает информацию о UID (идентификаторе пользователя) и GIDs (идентификаторы групп) для указанного пользователя.

### 2. UID пользователя root и команда для его получения
Пользователь `root` имеет UID 0. Узнать UID пользователя можно с помощью команды:
```bash
id root
```
или просто:
```bash
echo $UID
```
Эти команды выведут соответствующую информацию.

### 3. Различие между командами su и sudo
Команда `su` (switch user) позволяет переключаться на другого пользователя (по умолчанию на `root`), требуя его пароль. Команда `sudo` (superuser do) позволяет запускать команды с правами суперпользователя, используя при этом ваш собственный пароль. `sudo` более гибок и безопасен, особенно в многопользовательских системах.

### 4. Конфигурационный файл для sudo
Параметры для `sudo` определяются в конфигурационном файле:
```
/etc/sudoers
```
Этот файл можно редактировать с помощью команды `visudo`, что позволяет избежать синтаксических ошибок.

### 5. Команда для безопасного изменения конфигурации sudo
Для безопасного редактирования конфигурации `sudo` следует использовать команду:
```bash
visudo
```
Это предотвратит конфликт редактирования и проверит правильность синтаксиса.

### 6. Группа для администрирования через sudo
Чтобы предоставить пользователю доступ ко всем командам администрирования системы через `sudo`, он должен быть членом группы `sudo` или `wheel` (в зависимости от дистрибутива).

### 7. Файлы для настроек учетных записей
При создании учетных записей пользователей используются следующие файлы:
- **/etc/login.defs** — содержит параметры для создания учетных записей, такие как минимальная длина пароля.
- **/etc/default/useradd** — определяет параметры по умолчанию для команды `useradd`, например, домашний каталог.

### 8. Хранение информации о группах пользователей
Информация о первичных и дополнительных группах пользователей хранится в файле:
```
/etc/passwd
```
Запись для пользователя `alice` может выглядеть следующим образом:
```
alice:x:1001:1001::/home/alice:/bin/bash
```
Здесь `1001` — это UID, а `1001` после второго двоеточия — GID (идентификатор ее основной группы).

### 9. Команды для изменения информации о пароле
Для изменения информации о пароле пользователя, включая срок действия, можно использовать команды:
```bash
passwd username
```
и
```bash
chage -l username
```
Первая команда изменяет пароль, а вторая показывает параметры, связанные со сроками действия пароля.

### 10. Команда для изменения информации в файле /etc/group
Для изменения информации в файле `/etc/group` следует использовать команду:
```bash
vigr /etc/group
```
Это делается для обеспечения безопасности, так как `vigr` блокирует файл от одновременного доступа другими пользователями и проверяет синтаксис перед сохранением изменений.

---



# Выводы

Мы получили представление о работе с учётными записями пользователей и группами
пользователей в операционной системе типа Linux.

