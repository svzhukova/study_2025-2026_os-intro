---
## Front matter
title: "Лабораторная работа № 3"
subtitle: "Настройка прав доступа"
author: "Жукова София Викторовна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Целью данной работы является получение навыков настройки базовых и специальных прав доступа для групп пользователей в операционной системе типа Linux.



# Выполнение лабораторной работы

**Управление базовыми разрешениями**


Откройем терминал с учётной записью root (рис. [-@fig:001]).

![Pоль супер-пользователя](image/1.png){#fig:001 width=70%}


В корневом каталоге создадим каталоги /data/main и /data/third
Посмотрим, кто является владельцем этих каталогов. (рис. [-@fig:002]).

![каталоги /data/main и /data/third](image/2.png){#fig:002 width=70%}


Прежде чем устанавливать разрешения, изменим владельцев этих каталогов с root
на main и third соответственно
Посмотрим, кто теперь является владельцем этих каталогов (рис. [-@fig:003]).

![Изменим владельцев каталогов](image/3.png){#fig:003 width=70%}


Установим разрешения, позволяющие владельцам каталогов записывать файлы в эти
каталоги и запрещающие доступ к содержимому каталогов всем другим пользователям
и группам
Проверим установленные права доступа (рис. [-@fig:004]).

![Права доступа](image/4.png){#fig:004 width=70%}


В другом терминале перейдем под учётную запись пользователя bob (рис. [-@fig:005]).

![Учётная запись пользователя bob](image/5.png){#fig:005 width=70%}


Под пользователем bob попробуем перейти в каталог /data/main и создать файл
emptyfile в этом каталоге (рис. [-@fig:006]).

![emptyfile](image/6.png){#fig:006 width=70%}


Под пользователем bob попробуем перейти в каталог /data/third и создать файл
emptyfile в этом каталоге (рис. [-@fig:007]).


![Нам отказано в доступе, нет нужных прав](image/7.png){#fig:007 width=70%}

**Управление специальными разрешениями**

Откроем новый терминал под пользователем alice (рис. [-@fig:008]).


![alice](image/8.png){#fig:008 width=70%}


Перейдите в каталог /data/main и создадим два файла, владельцем которых является alice (рис. [-@fig:009]).


![Создадим два файла](image/9.png){#fig:009 width=70%}


В другом терминале перейдем под учётную запись пользователя bob (пользователь
bob является членом группы main, как и alice)
Перейдем в каталог /data/main и в этом каталоге введем (рис. [-@fig:010]).

![Мы видим два файла, созданные пользователем alice](image/10.png){#fig:010 width=70%}


Попробуем удалить файлы, принадлежащие пользователю alice (рис. [-@fig:011]).


![Файлы  удалены](image/11.png){#fig:011 width=70%}


Создадим два файла, которые принадлежат пользователю bob (рис. [-@fig:012]).


![Два файла, которые принадлежат пользователю bob](image/12.png){#fig:012 width=70%}


В терминале под пользователем root установим для каталога /data/main бит идентификатора группы, а также stiky-бит для разделяемого (общего) каталога группы (рис. [-@fig:013]).


![установим идентификатор группы, а также stiky-бит для разделяемого каталога группы](image/13.png){#fig:013 width=70%}


В терминале под пользователем alice создадим в каталоге /data/main файлы alice3
и alice4(рис. [-@fig:014]).


![Файлы alice3 и alice4](image/14.png){#fig:014 width=70%}

Теперь мы видим, что два созданных нами файла принадлежат группе main,
которая является группой-владельцем каталога /data/main

В терминале под пользователем alice попробуем удалить файлы, принадлежащие
пользователю bob(рис. [-@fig:015]).


![Операция недоступна](image/15.png){#fig:015 width=70%}

**Управление расширенными разрешениями с использованием списков ACL**

Откроем терминал с учётной записью root
Установим права на чтение и выполнение в каталоге /data/main для группы third
и права на чтение и выполнение для группы main в каталоге /data/third:(рис. [-@fig:016]).


![права на чтение и выполнение](image/16.png){#fig:016 width=70%}

Используем команду getfacl, чтобы убедиться в правильности установки разреше-
ний(рис. [-@fig:017]). (рис. [-@fig:018]).


![Правильность установки разрешений](image/17.png){#fig:017 width=70%}

![Правильность установки разрешени](image/18.png){#fig:018 width=70%}


Создадим новый файл с именем newfile1 в каталоге /data/main:
Проверим текущие назначения полномочий.  (рис. [-@fig:019]).


![Установим и проверим](image/19.png){#fig:019 width=70%}

Установим ACL по умолчанию для каталога /data/main:

Добавим ACL по умолчанию для каталога /data/third(рис. [-@fig:20]).

![Добавим](image/20.png){#fig:20 width=70%}


Убедимся, что настройки ACL работают, добавив новый файл в каталог /data/main:(рис. [-@fig:21]).


![Добавим новый файл в каталог](image/21.png){#fig:21 width=70%}


Проверим текущие назначения полномочий.(рис. [-@fig:22]).


![Проверим](image/22.png){#fig:22 width=70%}


Выполним аналогичные действия для каталога /data/third. (рис. [-@fig:23]).


![Выполним](image/23.png){#fig:23 width=70%}

Для проверки полномочий группы third в каталоге /data/third войдем в другом
терминале под учётной записью члена группы third
Проверим операции с файлами(рис. [-@fig:24]).


![Нельзя](image/24.png){#fig:24 width=70%}


Проверим, возможно ли осуществить запись в файл(рис. [-@fig:25]).


![Можно только во втором случае](image/25.png){#fig:25 width=70%}



**Контрольные вопросы**


 1. Использование команды `chown`
Чтобы установить владельца и группу для файла, используется команда `chown`. Пример:

```bash
chown user:group filename.txt
```
Чтобы сменить владельца файла `filename.txt` на `user` и группу на `group`.

2. Поиск файлов, принадлежащих конкретному пользователю
Для этого можно использовать команду `find`. Пример:

```bash
find /path/to/search -user username
```
Это найдет все файлы в указанном пути, принадлежащие пользователю `username`.

3. Применение разрешений для всех файлов в `/data`
Чтобы установить разрешения на чтение, запись и выполнение для всех владельцев и группы, но не для других, используйте команду `chmod`:

```bash
chmod 770 /data/*
```
Здесь `7` дает полные права для владельца и группы, а `0` — никаких прав для других.

4. Добавление разрешения на выполнение для файла
Используйте команду `chmod`, чтобы сделать файл исполняемым. Пример:

```bash
chmod +x filename.sh
```
Это добавит разрешение на выполнение для файла `filename.sh`.

5. Установка групповых разрешений для новых файлов
Чтобы все новые файлы, создаваемые в каталоге, наследовали группу этого каталога, используйте `chmod` с настройкой битов SGID. Пример:

```bash
chmod g+s /path/to/directory
```

 6. Удаление файлов только владельцами
Для ограничения прав удаления можно использовать `chmod`, чтобы убрать права на удаление для группы и других. Пример:

```bash
chmod o-w /path/to/directory
```
Эта команда убирает права записи для других пользователей, предотвращая их возможность удаления файлов.

7. Добавление ACL для группы
С помощью `setfacl` можно добавить права доступа для группы. Пример:

```bash
setfacl -m g:groupname:r /path/to/directory/*
```
Это добавит права на чтение для группы `groupname` для всех существующих файлов в каталоге.

 8. Гарантия прав чтения для всех файлов
Для того чтобы члены группы получили права чтения на все файлы и подкаталоги, используйте:

```bash
setfacl -R -m g:groupname:rX /path/to/directory
```
Это даст права чтения и выполнения для всех файлов и каталогов.

9. Установка umask для ограничения прав
Для того чтобы «другие» пользователи не получали разрешения на новые файлы, установите umask на `007`. Пример:

```bash
umask 007
```
Это гарантирует, что файлы создаются с правами 664 и каталоги с правами 775.

10. Защита файла от удаления
Чтобы гарантировать, что файл `myfile` не может быть удален случайно, можно установить только права на чтение и запись для владельца. Пример:

```bash
chmod 444 myfile
```
Это уберет все права на запись, что предотвратит случайное удаление файла.


# Выводы

Мы получили навыки настройки базовых и специальных прав доступа для групп пользователей в операционной системе типа Linux.
